---
title: "CRM Pexe: Ecossistema SaaS Enterprise"
summary: "Plataforma de gest√£o comercial Multi-tenant desenvolvida em Monorepo (TurboRepo). Integra CRM, Atendimento Omnichannel (WhatsApp), Automa√ß√£o de Processos (n8n) e Intelig√™ncia Artificial para Scoring de Leads."
tags: ["NestJS", "Next.js", "TurboRepo", "Docker", "Redis", "PostgreSQL", "Prisma", "OpenAI", "WebSockets"]
cover: "/images/projetos/crm-pexe-cover.jpg"
video: ""
order: 1
featured: true
---

## Vis√£o Geral do Produto

O **CRM Pexe** n√£o √© apenas uma ferramenta de gest√£o de contatos; √© um **SaaS (Software as a Service) Multi-tenant** projetado para centralizar toda a opera√ß√£o de vendas e atendimento de empresas.
A plataforma resolve o problema da fragmenta√ß√£o de dados, onde empresas usam uma ferramenta para WhatsApp, outra para Kanban de vendas e planilhas para financeiro. O Pexe unifica tudo isso em um √∫nico ecossistema, isolando dados por "Workspaces" e permitindo gest√£o granular de permiss√µes.

## Arquitetura de Engenharia (Deep Dive)

A decis√£o de arquitetura focou em **escalabilidade horizontal** e **manutenibilidade** a longo prazo.

### 1. Estrutura Monorepo (TurboRepo)
Para garantir consist√™ncia de tipagem e reutiliza√ß√£o de c√≥digo entre o Frontend e o Backend, adotei uma estrat√©gia de Monorepo:
* **Apps:** Separa√ß√£o clara entre `apps/web` (Next.js App Router) e `apps/api` (NestJS).
* **Shared Packages:** Utilit√°rios, configura√ß√µes de ESLint/Prettier e DTOs compartilhados, garantindo que uma mudan√ßa no Backend reflita imediatamente no Frontend (Type Safety end-to-end).

### 2. Backend Robusto (NestJS & Microservices-ready)
A API foi constru√≠da seguindo os princ√≠pios de **Clean Architecture** e **SOLID**:
* **Filas e Jobs (Redis + BullMQ):** Processos pesados, como o disparo de campanhas de mensagens ou o processamento de Webhooks do WhatsApp, s√£o enviados para filas no Redis. Isso impede que a API principal trave sob alta carga.
* **Banco de Dados (Prisma + PostgreSQL):** Uso de migrations controladas para evolu√ß√£o do esquema de dados, lidando com relacionamentos complexos entre `Workspaces`, `Deals`, `Contacts` e `Activities`.
* **Autentica√ß√£o & Seguran√ßa:** Implementa√ß√£o de JWT com Refresh Tokens e hash de senhas seguro. O sistema possui **RBAC (Role-Based Access Control)** completo, onde cada rota √© protegida por Guards que verificam se o usu√°rio tem permiss√£o para aquela a√ß√£o espec√≠fica dentro do Workspace.

### 3. M√≥dulos de Destaque

#### ü§ñ Motor de Automa√ß√£o e Integra√ß√µes (n8n)
Desenvolvi um m√≥dulo `automation-engine` interno. O sistema √© capaz de disparar gatilhos baseados em eventos de neg√≥cio (ex: "Lead mudou para a fase 'Fechamento'"). Al√©m disso, h√° uma integra√ß√£o nativa com **n8n**, permitindo que os clientes criem fluxos de trabalho visuais complexos que reagem a eventos do CRM.

#### üí¨ Omnichannel e WebSockets
O m√≥dulo de atendimento utiliza **WebSockets (Gateways do NestJS)** para comunica√ß√£o em tempo real.
* Quando uma mensagem de WhatsApp chega via integra√ß√£o (WPPConnect/API Oficial), ela √© processada via Webhook e enviada instantaneamente para a interface do atendente via socket, sem necessidade de *refresh*.
* Suporte a filas de atendimento e distribui√ß√£o de conversas entre agentes.

#### üß† Intelig√™ncia Artificial (Lead Scoring)
Implementa√ß√£o de um servi√ßo de IA (`ai.module.ts`) que analisa o hist√≥rico de conversas e dados do lead. Utilizando a API da OpenAI, o sistema atribui automaticamente uma "pontua√ß√£o de temperatura" ao lead, ajudando o vendedor a priorizar quem est√° mais propenso a comprar.

#### üí∞ M√≥dulo Financeiro (Billing)
Sistema completo de gest√£o de assinaturas SaaS integrado ao **Mercado Pago**.
* Controle de planos (Free, Pro, Enterprise).
* Gest√£o de consumo de cr√©ditos (para uso de IA ou disparo de mensagens em massa).
* Webhooks de pagamento para libera√ß√£o autom√°tica de funcionalidades.

## Infraestrutura e DevOps

O projeto √© "Cloud Native", rodando inteiramente em containers:
* **Docker Compose:** Orquestra√ß√£o completa do ambiente de desenvolvimento e produ√ß√£o (API, Banco, Redis, Adminer).
* **CI/CD:** Pipelines configurados (GitHub Actions) para rodar testes (Jest e2e) e linting antes de qualquer deploy, garantindo a qualidade do c√≥digo.

## O Resultado

O CRM Pexe representa um projeto de n√≠vel **S√™nior/Arquiteto**, demonstrando dom√≠nio n√£o apenas de c√≥digo, mas de design de sistemas complexos. Ele une performance (Redis/NestJS), experi√™ncia de usu√°rio (Next.js/Real-time) e valor de neg√≥cio (Automa√ß√£o/IA).
